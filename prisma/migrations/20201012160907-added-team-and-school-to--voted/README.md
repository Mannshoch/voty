# Migration `20201012160907-added-team-and-school-to--voted`

This migration has been generated by Stefan N at 10/12/2020, 6:09:07 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."voted" ADD COLUMN "team_id" text   ,
ADD COLUMN "school_id" text   

ALTER TABLE "public"."voted" ADD FOREIGN KEY ("team_id")REFERENCES "public"."teams"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."voted" ADD FOREIGN KEY ("school_id")REFERENCES "public"."schools"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201012145800-add--code--to-team--which-allows-anonymous-voting-for-teams-panels..20201012160907-added-team-and-school-to--voted
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgres"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -85,8 +85,9 @@
   User      User[]
   BallotRun BallotRun[]
   Vote      Vote[]
   @@map(name: "teams")
+  Voted Voted[]
 }
 model School {
   id      String @id @default(cuid())
@@ -104,8 +105,9 @@
   ballots  Ballot[]
   Vote Vote[]
   @@map(name: "schools")
+  Voted Voted[]
 }
 model Domain {
   id       String  @id @default(cuid())
@@ -192,12 +194,16 @@
   id String @id @default(cuid())
   signature String? // encrypted signature of the user
-  user     User   @relation(name: "VotedUser", fields: [userId], references: [id])
-  userId   String @map(name: "user_id")
-  ballot   Ballot @relation(name: "VotedBallot", fields: [ballotId], references: [id])
-  ballotId String @map(name: "ballot_id")
+  user     User    @relation(name: "VotedUser", fields: [userId], references: [id])
+  userId   String  @map(name: "user_id")
+  ballot   Ballot  @relation(name: "VotedBallot", fields: [ballotId], references: [id])
+  ballotId String  @map(name: "ballot_id")
+  team     Team?   @relation(fields: [teamId], references: [id])
+  teamId   String? @map(name: "team_id")
+  school   School? @relation(fields: [schoolId], references: [id])
+  schoolId String? @map(name: "school_id")
   @@map(name: "voted")
 }
```


