# Migration `20201012145800-add--code--to-team--which-allows-anonymous-voting-for-teams-panels`

This migration has been generated by Stefan N at 10/12/2020, 4:58:00 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."teams" ADD COLUMN "code" text   

CREATE UNIQUE INDEX "teams.code_unique" ON "public"."teams"("code")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201012140134-added-team-and-school-to-votes..20201012145800-add--code--to-team--which-allows-anonymous-voting-for-teams-panels
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgres"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -68,9 +68,10 @@
 model Team {
   id     String  @id @default(cuid())
   name   String
-  invite String? @unique
+  invite String? @unique // inviteCode to generate accounts
+  code   String? @unique // code to allow voting for ballotRuns from this team
   year   Int? // in what year (roughly) were kids born (now - schoolyear - 5y)
   school    School   @relation(fields: [schoolId], references: [id])
   schoolId  String   @map(name: "school_id")
@@ -80,12 +81,12 @@
   ballots   Ballot[]
   domain    Domain?  @relation(fields: [domainId], references: [id])
   domainId  String?  @map(name: "domain_id")
-  User User[]
-  @@map(name: "teams")
+  User      User[]
   BallotRun BallotRun[]
   Vote      Vote[]
+  @@map(name: "teams")
 }
 model School {
   id      String @id @default(cuid())
@@ -101,10 +102,10 @@
   members  User[]
   teams    Team[]
   ballots  Ballot[]
+  Vote Vote[]
   @@map(name: "schools")
-  Vote Vote[]
 }
 model Domain {
   id       String  @id @default(cuid())
@@ -156,12 +157,12 @@
   voted       Voted[]      @relation("VotedBallot")
   votes       Vote[]
   attachments Attachment[]
-  createdAt DateTime @default(now()) @map(name: "created_at")
-  updatedAt DateTime @default(now()) @map(name: "updated_at")
+  createdAt DateTime    @default(now()) @map(name: "created_at")
+  updatedAt DateTime    @default(now()) @map(name: "updated_at")
+  BallotRun BallotRun[]
   @@map(name: "ballots")
-  BallotRun BallotRun[]
 }
 model BallotRun {
   id    String    @id @default(cuid())
```


