# Migration `20200824131042-changed-domain-attribute-in-school-to-relation`

This migration has been generated by Stefan N at 8/24/2020, 3:10:42 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."schools" DROP COLUMN "domain",
ADD COLUMN "domainId" integer   ;

ALTER TABLE "public"."schools" ADD FOREIGN KEY ("domainId")REFERENCES "public"."domains"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200824120050-added-a-few-ballot-modules-incl--threads-and-attachments..20200824131042-changed-domain-attribute-in-school-to-relation
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgres"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -106,21 +106,25 @@
   userId Int?
 }
 model School {
-  id      Int      @default(autoincrement()) @id
-  name    String
-  domain  String
-  members User[]   @relation("SchoolUser")
-  teams   Team[]   @relation("SchoolTeam")
-  ballots Ballot[]
+  id       Int      @default(autoincrement()) @id
+  name     String
+  domain   Domain?  @relation(fields: [domainId], references: [id])
+  domainId Int?
+  members  User[]   @relation("SchoolUser")
+  teams    Team[]   @relation("SchoolTeam")
+  ballots  Ballot[]
+
   @@map(name: "schools")
 }
 model Domain {
-  id       Int     @default(autoincrement()) @id
-  name     String  @unique
-  approved Boolean @default(false)
+  id       Int      @default(autoincrement()) @id
+  name     String   @unique
+  approved Boolean  @default(false)
+  schools  School[]
+
   @@map(name: "domains")
 }
 enum Scope {
```


