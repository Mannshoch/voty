# Migration `20200910150459-fixed-nexus-bug-on-voted`

This migration has been generated by Stefan N at 9/10/2020, 5:04:59 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."voted" ADD COLUMN "signature" text   
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200910144622-clean-up-of-fields..20200910150459-fixed-nexus-bug-on-voted
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgres"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -76,9 +76,9 @@
   ballots     Ballot[]
   attachments Attachment[]
   threads     Thread[]
   reactions   Reaction[]
-  voted       Voted[]
+  voted       Voted[]      @relation("VotedUser")
   createdAt DateTime @default(now()) @map(name: "created_at")
   updatedAt DateTime @default(now()) @map(name: "updated_at")
   @@map(name: "users")
@@ -168,9 +168,9 @@
   thread    Thread? @relation(fields: [threadId], references: [id])
   threadId  Int?    @map(name: "thread_id")
   options     Options[]
-  voted       Voted[]
+  voted       Voted[]      @relation("VotedBallot")
   votes       Votes[]
   attachments Attachment[]
   createdAt DateTime @default(now()) @map(name: "created_at")
@@ -191,11 +191,13 @@
 model Voted {
   id Int @default(autoincrement()) @id
-  user     User   @relation(fields: [userId], references: [id])
+  signature String? // encrypted signature of the user
+
+  user     User   @relation(name: "VotedUser", fields: [userId], references: [id])
   userId   Int    @map(name: "user_id")
-  ballot   Ballot @relation(fields: [ballotId], references: [id])
+  ballot   Ballot @relation(name: "VotedBallot", fields: [ballotId], references: [id])
   ballotId Int    @map(name: "ballot_id")
   @@map(name: "voted")
 }
```


